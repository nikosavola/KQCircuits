

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Testing &mdash; KQCircuits  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/logo.svg"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Coding Style" href="coding_style.html" />
    <link rel="prev" title="Architecture" href="architecture.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> KQCircuits
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup.html">Developer Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="standalone.html">KLayout Standalone Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker_image.html">Docker image</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unit-tests">Unit tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="coding_style.html">Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../libraries/index.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/kqcircuits.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trademarks.html">Trademarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">KQCircuits</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Developer Guide</a> &raquo;</li>
        
      <li>Testing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/developer/testing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="testing">
<span id="id1"></span><h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<p>KQCircuits uses <cite>tox</cite> for running tests. It runs tools for different types of
tests, such as <cite>pytest</cite> for unit tests or <cite>pylint</cite> for linting. The
configuration of <cite>tox</cite> is done in <cite>tox.ini</cite>. You can execute all tests by
executing <cite>tox</cite>, or you can use separate commands like <cite>pytest</cite> to run
certain types of tests. The CI/CD pipeline uses <cite>tox</cite> to run the tests.</p>
<div class="section" id="unit-tests">
<h2>Unit tests<a class="headerlink" href="#unit-tests" title="Permalink to this headline">¶</a></h2>
<p>KQCircuits uses the pytest framework for unit tests. Run the unit tests by
executing <cite>pytest</cite> or <cite>pytest -n &lt;NUM&gt;</cite> for some speed-up on  multi core CPUs.</p>
<p>All tests are placed in a separate
<code class="docutils literal notranslate"><span class="pre">tests</span></code> folder in the project root. This folder should reflect the same hierarchy as
for the kqcircuits source folder. For example, if you are writing tests for
<code class="docutils literal notranslate"><span class="pre">kqcircuits/util/library_helper.py</span></code>, then you would create and use the same path to
the corresponding folder containing tests for <code class="docutils literal notranslate"><span class="pre">library_helper.py</span></code> such as
<code class="docutils literal notranslate"><span class="pre">tests/util/library_helper</span></code>.</p>
<p>For better organization and improved reporting, create a folder for each module
that you test. This folder would then contain a module for each method that you
want to test. Within that module, you would have test functions for each case
that you want to test for that method. For example, continuing to use
<code class="docutils literal notranslate"><span class="pre">library_helper.py</span></code> to demonstrate the proposed structure, the <code class="docutils literal notranslate"><span class="pre">library_helper</span></code> folder
would have a <code class="docutils literal notranslate"><span class="pre">test_load_library.py</span></code> module which may contain test cases such as
<code class="docutils literal notranslate"><span class="pre">test_invalid_name</span></code>.</p>
<p>If your module contains a class, using the <code class="docutils literal notranslate"><span class="pre">validate</span></code> method in the <code class="docutils literal notranslate"><span class="pre">Validator</span></code> class
within <code class="docutils literal notranslate"><span class="pre">parameter_helper.py</span></code>, then you would have a <code class="docutils literal notranslate"><span class="pre">tests/util/parameter_helper</span></code> folder
and within it you would have a <code class="docutils literal notranslate"><span class="pre">test_validator_validate.py</span></code> module which may contain test
cases such as <code class="docutils literal notranslate"><span class="pre">test_type_boolean</span></code>. In this case, we form the test module name by
a combination of the class and method names.</p>
<p>The above approach helps us organize our test cases into files which can easily be located
and do not get too large, while also producing pytest reports which are easy to understand.
Unfortunately, the repetitive <code class="docutils literal notranslate"><span class="pre">test</span></code> prefixes are conventional and needed for pytest to find
and/or filter tests at both module and function level. The required
prefixes/postfixes for the tests are defined in <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>. Do not change
them without careful consideration, or the unit tests may not run properly.</p>
<p>You can run all tests and view coverage by running
the following command in the project root directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">--</span><span class="n">cov</span> <span class="o">--</span><span class="n">cov</span><span class="o">-</span><span class="n">report</span> <span class="n">term</span><span class="o">-</span><span class="n">missing</span> <span class="o">-</span><span class="n">rf</span>
</pre></div>
</div>
<p>Refer to <a class="reference external" href="https://docs.pytest.org/">pytest</a> documentation for other options, such as running single tests.</p>
<p>If you develop a new feature for the project, make sure you write
a comprehensive set of unit tests which cover happy paths,
points of failure, edge cases, and so on.</p>
<p>Do not test private methods directly, but only their effects on the public methods that call them.</p>
<p>Similarly, if you fix a bug, write a test that would have failed prior to your fix,
so you can be sure that the bug wil not be reintroduced later.</p>
<p>Please note that the empty <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> file in the project root is required
so that pytest can follow imports to source code.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="coding_style.html" class="btn btn-neutral float-right" title="Coding Style" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="architecture.html" class="btn btn-neutral float-left" title="Architecture" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021-2022, IQM.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>